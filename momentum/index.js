(()=>{"use strict";const e=()=>{null==localStorage.getItem("language")&&localStorage.setItem("language","en"),null==localStorage.getItem("imgSource")&&localStorage.setItem("imgSource","github"),null==localStorage.getItem("time")&&localStorage.setItem("time",!0),null==localStorage.getItem("date")&&localStorage.setItem("date",!0),null==localStorage.getItem("greeting")&&localStorage.setItem("greeting",!0),null==localStorage.getItem("quote")&&localStorage.setItem("quote",!0),null==localStorage.getItem("weather")&&localStorage.setItem("weather",!0),null==localStorage.getItem("player")&&localStorage.setItem("player",!0),null==localStorage.getItem("city")&&localStorage.setItem("city","Minsk");let e={language:localStorage.getItem("language"),imgSource:localStorage.getItem("imgSource"),time:localStorage.getItem("time"),date:localStorage.getItem("date"),greeting:localStorage.getItem("greeting"),quote:localStorage.getItem("quote"),weather:localStorage.getItem("weather"),player:localStorage.getItem("player"),enError:"Sorry, something went wrong...",ruError:"Извините, что-то пошло не так..."};const t=document.querySelector(".weather-icon"),n=document.querySelector(".temperature"),o=document.querySelector(".weather-description"),a=document.querySelector(".wind"),s=document.querySelector(".humidity"),c=document.querySelector(".city"),r=document.querySelector(".weather-error"),l=document.querySelector(".quote"),i=document.querySelector(".author"),d=document.querySelector(".change-quote");function u(e=0,t=19){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e+1))+e}async function m(l,i=e.language){try{const e=`https://api.openweathermap.org/data/2.5/weather?q=${l}&lang=${i}&appid=4210f79be2d65c6e8c2376a9120f9018&units=metric`,c=await fetch(e),d=await c.json();t.className="weather-icon owf",t.classList.add(`owf-${d.weather[0].id}`),n.textContent=`${Math.floor(d.main.temp)}°C`,o.textContent=d.weather[0].description,"en"==i?(a.textContent=`Wind speed: ${Math.ceil(d.wind.speed)} m/s`,s.textContent=`Humidity: ${d.main.humidity}% `):"ru"==i&&(a.textContent=`Скорость ветра: ${Math.ceil(d.wind.speed)} м/с`,s.textContent=`Влажность: ${d.main.humidity}% `),r.textContent=""}catch(e){""===l?"en"==i?(c.setAttribute("placeholder","[Enter sity]"),r.textContent="Error! Nothing to geocode for ' '!"):"ru"==i&&(c.setAttribute("placeholder","[Введите город]"),r.textContent="Ошибка! Ничего не найдено как ' '!"):r.textContent="en"==i?`Error! city not found for ${l}!`:`Ошибка! Не найден город ${l}!`,n.textContent="",o.textContent="",a.textContent="",s.textContent=""}}null==localStorage.getItem("city")&&localStorage.setItem("city",c.value),c.value=localStorage.getItem("city"),c.addEventListener("change",(()=>{localStorage.setItem("city",c.value),m(c.value)})),m(c.value);let g=u();async function L(t=e.language){const n=await fetch("./assets/data.json"),o=await n.json();"en"==t?(l.textContent=o[g].enQuote,i.textContent=o[g].enAuthor):"ru"==t&&(l.textContent=o[g].ruQuote,i.textContent=o[g].ruAuthor)}L(),d.addEventListener("click",(()=>{g=u(),L()}));const v=document.querySelector("time"),p=document.querySelector("date"),S=document.querySelector(".greeting"),h=document.querySelector(".name"),y=document.querySelector("body");let f=function(e=20){return Math.floor(Math.random()*e)+1}();const I=document.querySelector(".slide-next"),k=document.querySelector(".slide-prev");function q(t=e.language){const n=(new Date).toLocaleTimeString();v.textContent=n,function(t=e.language){const n=new Date,o={weekday:"long",month:"long",day:"numeric",timeZone:"UTC"};let a;"en"==t?a=n.toLocaleDateString("en-EN",o):"ru"==t&&(a=n.toLocaleDateString("ru-RU",o));p.textContent=a}(t),function(t=e.language){let n=C();"en"==t?S.textContent=`Good ${E[n]}`:"ru"==t&&(S.textContent=w[n])}(t),setTimeout(q,1e3)}const E={morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},w={morning:"Доброе утро",afternoon:"Добрый день",evening:"Добрый вечер",night:"Доброй ночи"};function C(){const e=(new Date).getHours();return e>=6&&e<12?"morning":e>=12&&e<18?"afternoon":e>=18&&e<24?"evening":e>=0&&e<6?"night":void 0}function x(){let e=C(),t=f;t<10&&(t="0"+f);const n=new Image;n.src=`https://raw.githubusercontent.com/dumbus/stage1-tasks/assets/images/${e}/${t}.jpg`,n.onload=()=>{y.style.backgroundImage=`url("${n.src}")`}}function b(){f+=1,21==f&&(f=1),x()}function $(){f-=1,0==f&&(f=20),x()}window.addEventListener("beforeunload",(function(){localStorage.setItem("name",h.value)})),window.addEventListener("load",(function(){localStorage.getItem("name")&&(h.value=localStorage.getItem("name"))})),x(),q();const M=document.querySelector(".settings-background-tags");let O,T,A=C();async function j(t=e.language){try{A=localStorage.getItem("tag");const e=`https://www.flickr.com/services/rest/?method=flickr.photos.search&api_key=ef16d9b8603933f2c3c1c961b2f5f0ea&tags=${A}&extras=url_l&format=json&nojsoncallback=1`,t=await fetch(e),o=await t.json();let a=(n=20,Math.floor(Math.random()*n));return O=o.photos.photo[a].url_l,await O}catch(n){console.log(n),"en"==t?alert(e.enError):"ru"==t&&alert(e.ruError)}var n}async function N(){O=await j();const e=new Image;e.src=O,e.onload=()=>{y.style.backgroundImage=`url("${e.src}")`}}async function D(){T=await async function(t=e.language){try{A=localStorage.getItem("tag");const e=`https://api.unsplash.com/photos/random?orientation=landscape&query=${A}&client_id=bHZ60GY9R1AgaR3EYhPVdg2eIGU5CoCNuCYUy1c1bqQ`,t=await fetch(e),n=await t.json();return T=n.urls.regular,console.log(e),await T}catch(n){"en"==t?alert(e.enError):"ru"==t&&alert(e.ruError)}}();const t=new Image;t.src=T,t.onload=()=>{y.style.backgroundImage=`url("${t.src}")`}}null==localStorage.getItem("tag")&&localStorage.setItem("tag",A),e.tag=localStorage.getItem("tag"),M.value=e.tag,M.addEventListener("input",(()=>{A=M.value,localStorage.setItem("tag",A)}));const R=document.querySelector(".settings-button"),Y=document.querySelector(".settings-button-text"),G=document.querySelector(".settings-popup"),Q=document.querySelector(".close");R.addEventListener("click",(()=>{G.classList.contains("opened-popup")?(G.classList.remove("fadeIn"),G.classList.add("fadeOut"),G.classList.remove("opened-popup"),G.addEventListener("animationend",(()=>{G.classList.add("closed-popup"),G.classList.remove("opened-popup")}))):(G.classList.remove("closed-popup"),G.classList.remove("fadeOut"),G.classList.add("fadeIn"),G.addEventListener("animationend",(()=>{G.classList.remove("closed-popup"),G.classList.add("opened-popup")})))})),Q.addEventListener("click",(()=>{G.classList.remove("fadeIn"),G.classList.add("fadeOut"),G.classList.remove("opened-popup"),G.addEventListener("animationend",(()=>{G.classList.add("closed-popup"),G.classList.remove("opened-popup")}))}));const U="Settings",W="Tag for images",_="Time",H="Date",F="Greeting",Z="Quote",B="Weather",P="Audio player",V="Настройки",z="Тэг для изображений",J="Время",K="Дата",X="Приветствие",ee="Цитата",te="Погода",ne="Аудиоплеер",oe=document.querySelector(".popup-header"),ae=document.querySelector(".settings-tag"),se=document.querySelector(".setting-hide-time"),ce=document.querySelector(".setting-hide-date"),re=document.querySelector(".setting-hide-greeting"),le=document.querySelector(".setting-hide-quote"),ie=document.querySelector(".setting-hide-weather"),de=document.querySelector(".setting-hide-player");function ue(t=e.language){"en"==t?(Y.textContent=U,oe.textContent=U,ae.textContent=W,se.textContent=_,ce.textContent=H,re.textContent=F,le.textContent=Z,ie.textContent=B,de.textContent=P):"ru"==t&&(Y.textContent=V,oe.textContent=V,ae.textContent=z,se.textContent=J,ce.textContent=K,re.textContent=X,le.textContent=ee,ie.textContent=te,de.textContent=ne)}ue();const me=document.querySelector(".language-input-eng"),ge=document.querySelector(".language-input-ru");function Le(){me.checked&&(localStorage.setItem("language","en"),e.language="en"),ge.checked&&(localStorage.setItem("language","ru"),e.language="ru")}"en"==e.language?(me.checked=!0,ge.checked=!1):"ru"==e.language&&(ge.checked=!0,me.checked=!1),me.addEventListener("input",(()=>{Le(),q(),m(c.value),ue(),L()})),ge.addEventListener("input",(()=>{Le(),q(),m(c.value),ue(),L()}));const ve=document.querySelector(".background-input-gt"),pe=document.querySelector(".background-input-un"),Se=document.querySelector(".background-input-fl"),he=document.querySelector(".settings-tag-container");function ye(){ve.checked&&(localStorage.setItem("imgSource","github"),e.imgSource="github",he.classList.add("hidden")),pe.checked&&(localStorage.setItem("imgSource","unsplash"),e.imgSource="unsplash",he.classList.remove("hidden")),Se.checked&&(localStorage.setItem("imgSource","flickr"),e.imgSource="flickr",he.classList.remove("hidden"))}function fe(){"github"==e.imgSource&&(I.addEventListener("click",b),k.addEventListener("click",$),I.removeEventListener("click",N),k.removeEventListener("click",N),I.removeEventListener("click",D),k.removeEventListener("click",D)),"flickr"==e.imgSource&&(I.addEventListener("click",N),k.addEventListener("click",N),I.removeEventListener("click",b),k.removeEventListener("click",$),I.removeEventListener("click",D),k.removeEventListener("click",D)),"unsplash"==e.imgSource&&(I.addEventListener("click",D),k.addEventListener("click",D),I.removeEventListener("click",b),k.removeEventListener("click",$),I.removeEventListener("click",N),k.removeEventListener("click",N))}"github"==e.imgSource?(ve.checked=!0,pe.checked=!1,Se.checked=!1):"unsplash"==e.imgSource?(ve.checked=!1,pe.checked=!0,Se.checked=!1):"flickr"==e.imgSource&&(ve.checked=!1,pe.checked=!1,Se.checked=!0),ye(),fe(),ve.addEventListener("input",(()=>{ye(),fe()})),pe.addEventListener("input",(()=>{ye(),fe()})),Se.addEventListener("input",(()=>{ye(),fe()}));const Ie=document.querySelector(".hide-time"),ke=document.querySelector(".hide-date"),qe=document.querySelector(".hide-greeting"),Ee=document.querySelector(".hide-quote"),we=document.querySelector(".hide-weather"),Ce=document.querySelector(".hide-player"),xe=document.querySelector(".time"),be=document.querySelector(".date"),$e=document.querySelector(".greeting-container"),Me=document.querySelector(".quote-block"),Oe=document.querySelector(".weather"),Te=document.querySelector(".player");function Ae(){1==Ie.checked?(localStorage.setItem("time","true"),e.time="true"):(localStorage.setItem("time","false"),e.time="false"),1==ke.checked?(localStorage.setItem("date","true"),e.date="true"):(localStorage.setItem("date","false"),e.date="false"),1==qe.checked?(localStorage.setItem("greeting","true"),e.greeting="true"):(localStorage.setItem("greeting","false"),e.greeting="false"),1==Ee.checked?(localStorage.setItem("quote","true"),e.quote="true"):(localStorage.setItem("quote","false"),e.quote="false"),1==we.checked?(localStorage.setItem("weather","true"),e.weather="true"):(localStorage.setItem("weather","false"),e.weather="false"),1==Ce.checked?(localStorage.setItem("player","true"),e.player="true"):(localStorage.setItem("player","false"),e.player="false")}"true"==localStorage.getItem("time")?Ie.checked=!0:(Ie.checked=!1,xe.classList.add("closed-items")),"true"==localStorage.getItem("date")?ke.checked=!0:(ke.checked=!1,be.classList.add("closed-items")),"true"==localStorage.getItem("greeting")?qe.checked=!0:(qe.checked=!1,$e.classList.add("closed-items")),"true"==localStorage.getItem("quote")?Ee.checked=!0:(Ee.checked=!1,Me.classList.add("closed-items")),"true"==localStorage.getItem("weather")?we.checked=!0:(we.checked=!1,Oe.classList.add("closed-items")),"true"==localStorage.getItem("player")?Ce.checked=!0:(Ce.checked=!1,Te.classList.add("closed-items")),Ie.addEventListener("input",(()=>{Ae(),"false"==e.time?(xe.classList.remove("fadeInItems"),xe.classList.add("fadeOutItems"),xe.classList.remove("opened-items"),xe.addEventListener("animationend",(()=>{xe.classList.add("closed-items"),xe.classList.remove("opened-items")}))):(xe.classList.remove("fadeOutItems"),xe.classList.add("fadeInItems"),xe.classList.remove("closed-items"),xe.addEventListener("animationend",(()=>{xe.classList.add("opened-items"),xe.classList.remove("closed-items")})))})),ke.addEventListener("input",(()=>{Ae(),"false"==e.date?(be.classList.remove("fadeInItems"),be.classList.add("fadeOutItems"),be.classList.remove("opened-items"),be.addEventListener("animationend",(()=>{be.classList.add("closed-items"),be.classList.remove("opened-items")}))):(be.classList.remove("fadeOutItems"),be.classList.add("fadeInItems"),be.classList.remove("closed-items"),be.addEventListener("animationend",(()=>{be.classList.add("opened-items"),be.classList.remove("closed-items")})))})),qe.addEventListener("input",(()=>{Ae(),"false"==e.greeting?($e.classList.remove("fadeInItems"),$e.classList.add("fadeOutItems"),$e.classList.remove("opened-items"),$e.addEventListener("animationend",(()=>{$e.classList.add("closed-items"),$e.classList.remove("opened-items")}))):($e.classList.remove("fadeOutItems"),$e.classList.add("fadeInItems"),$e.classList.remove("closed-items"),$e.addEventListener("animationend",(()=>{$e.classList.add("opened-items"),$e.classList.remove("closed-items")})))})),Ee.addEventListener("input",(()=>{Ae(),"false"==e.quote?(Me.classList.remove("fadeInItems"),Me.classList.add("fadeOutItems"),Me.classList.remove("opened-items"),Me.addEventListener("animationend",(()=>{Me.classList.add("closed-items"),Me.classList.remove("opened-items")}))):(Me.classList.remove("fadeOutItems"),Me.classList.add("fadeInItems"),Me.classList.remove("closed-items"),Me.addEventListener("animationend",(()=>{Me.classList.add("opened-items"),Me.classList.remove("closed-items")})))})),we.addEventListener("input",(()=>{Ae(),"false"==e.weather?(Oe.classList.remove("fadeInItems"),Oe.classList.add("fadeOutItems"),Oe.classList.remove("opened-items"),Oe.addEventListener("animationend",(()=>{Oe.classList.add("closed-items"),Oe.classList.remove("opened-items")}))):(Oe.classList.remove("fadeOutItems"),Oe.classList.add("fadeInItems"),Oe.classList.remove("closed-items"),Oe.addEventListener("animationend",(()=>{Oe.classList.add("opened-items"),Oe.classList.remove("closed-items")})))})),Ce.addEventListener("input",(()=>{Ae(),"false"==e.player?(Te.classList.remove("fadeInItems"),Te.classList.add("fadeOutItems"),Te.classList.remove("opened-items"),Te.addEventListener("animationend",(()=>{Te.classList.add("closed-items"),Te.classList.remove("opened-items")}))):(Te.classList.remove("fadeOutItems"),Te.classList.add("fadeInItems"),Te.classList.remove("closed-items"),Te.addEventListener("animationend",(()=>{Te.classList.add("opened-items"),Te.classList.remove("closed-items")})))}))},t=()=>{const e=document.querySelector("audio"),t=document.querySelector(".play"),n=document.querySelector(".play-list"),o=document.querySelector(".play-prev"),a=document.querySelector(".play-next");let s;const c=document.querySelector(".player-name"),r=document.querySelector(".current-timing"),l=document.querySelector(".duration-timing"),i=document.querySelector(".muteButton"),d=document.querySelector(".volume-progress"),u=document.querySelector(".player-progress");let m=!1,g=!0,L=.5,v=0;const p=[{title:"Aqua Caelestis",src:"./assets/sounds/Aqua Caelestis.mp3",duration:"00:15"},{title:"River Flows In You",src:"./assets/sounds/River Flows In You.mp3",duration:"00:15"},{title:"Summer Wind",src:"./assets/sounds/Summer Wind.mp3",duration:"00:15"},{title:"Ennio Morricone",src:"./assets/sounds/Ennio Morricone.mp3",duration:"00:15"}];function S(){s=n.childNodes,s[v].classList.add("item-active"),t.classList.toggle("pause"),m?(e.pause(),m=!1):(e.src=p[v].src,c.textContent=p[v].title,l.textContent=p[v].duration,e.play(),m=!0)}function h(){e.volume=L,i.style.opacity=1}function y(){e.volume=0,i.style.opacity=.2}function f(){t.classList.remove("pause"),s=n.childNodes,s[v].classList.remove("item-active"),v+=1,4==v&&(v=0),s[v].classList.add("item-active"),m=!1,e.src=p[v].src,e.currentTime=0,S()}e.addEventListener("timeupdate",(function(){var t=Math.floor(e.currentTime/e.duration*100)||0,n=e.currentTime/e.duration||0;let o=Math.floor(t/6.66);o<10&&(o="0"+o),r.textContent=`00:${o}`,u.value=n,100===t&&f()})),i.addEventListener("click",(()=>{g?(h(),g=!1,d.value=L):(y(),g=!0,d.value=0)})),t.addEventListener("click",S),p.forEach((e=>{const t=document.createElement("li");t.classList.add("play-item"),t.classList.add("playlist-item-container"),t.textContent=e.title,n.append(t);const o=document.createElement("button");o.classList.add("play"),o.classList.add("player-icon"),o.classList.add("playlist-button"),o.classList.add("playlist-button-secondary"),t.prepend(o)})),a.addEventListener("click",f),o.addEventListener("click",(function(){t.classList.remove("pause"),s=n.childNodes,s[v].classList.remove("item-active"),v-=1,-1==v&&(v=3),s[v].classList.add("item-active"),m=!1,e.src=p[v].src,e.currentTime=0,S()})),e.src=p[v].src,c.textContent=p[v].title,r.textContent="00:00",l.textContent=p[v].duration,d.addEventListener("input",(function(){L=d.value,e.volume=L,0==e.volume?y():h()})),u.addEventListener("input",(function(){e.currentTime=Math.floor(100*u.value/6.66)}));const I=document.querySelectorAll(".playlist-button-secondary");function k(e){s=n.childNodes,s.forEach((e=>{e.classList.remove("item-active")})),s[e].classList.add("item-active")}for(let e=0;e<I.length;e++)I[e].addEventListener("click",(()=>{v=e,I[v].classList.toggle("pause"),k(e),S()}))};window.addEventListener("DOMContentLoaded",(()=>{e(),t()}))})();